---
title: 优化WebVR应用程序
template: usermanual-page.tmpl.html
position: 3
---

## 简介

高度并一致的帧率对于制作和享受VR或WebVR的体验至关重要。 当创建WebVR内容时，比以前更重要的是在开发早期就同步进行测试和优化，并在整个开发过程中保持目标帧速率。

由于要求每只眼睛位置的相机都必须呈现场景一次，WebVR的性能开销很大。 PlayCanvas引擎包含了许多对此的优化，以确保VR渲染不会重复太多的工作，但立体渲染仍然比单色渲染更耗性能。 此外，像Oculus Rift和HTC Vive等设备则需要更高的帧速率，例如75Hz或90Hz，这意味着渲染帧的时间更少。 移动VR虽然不具有高帧速率，但可能存在另一个问题，即缺乏对失真呈现的原生支持，这意味着之后处理阶段需要在Javascript和WebGL中完成，会增加额外的开销。

但是，并不是所有方法都不可行了。 PlayCanvas中包含许多专门设计的功能，可让您的应用程序在更短的时间内执行更多操作。

### 运行时生成光照贴图

每个动态光具有每帧运行时的成本。 灯光越多，成本就越高，场景渲染的速度就越慢。 通过将灯光烘焙成光照贴图，您可以大大降低静态灯的成本，简单地渲染纹理。 光照贴图可以使用您喜爱的3D建模工具离线生成，或者您也可以使用PlayCanvas的内置运行时光照贴图生成。

查阅更多关于 [运行时生成光照贴图][1]的信息。

### 谨慎地开启实时阴影功能

由于相似的原因，动态阴影也具有每帧运行时成本。 特别是点光源所产生的阴影，它需要对场景进行6次渲染，以产生阴影。 你应该避免让许多灯光投射动态阴影的情况出现。

### 查看您的填充率和绘制量

填充率是指应用于屏幕上每个像素的着色器操作数。 如果你片段着色器计算量十分高(例如大量的灯光和复杂的材料)和设置了高分辨率(例如手机具有高设备像素比率)，那么你的应用程序将花费太多的时间渲染场景以维持高帧速率。

过度绘制指的是被接近摄像机的其他几何体遮挡的几何体覆盖了多少像素。 过多的绘制显示您正在浪费GPU处理，试图对不可见的像素进行绘制。

使用[WebGL Insight] [2]这样的扩展可以帮助您可视化过度绘制的情况。

### 垃圾回收机制

Web浏览器有对不再使用的Javascript对象进行垃圾回收的功能。 PlayCanvas引擎被设计为最小化运行时分配，你应该尝试在代码中做同样的事情。 预分配向量和其他对象，并重新使用它们，以便每一帧不会出现大量的对象创建和销毁。

### 分析工具

PlayCanvas自带一个内置的分析工具。 在编辑器中使用Launch Profiler按钮运行具有分析活动的应用程序。 [阅读更多关于profiler的信息] [3]。

### 一般的优化提示

可用的[更多优化准则] [4]。

[1]: /user-manual/graphics/lighting/lightmaps/#playcanvas-runtime-lightmap-generation
[2]: https://chrome.google.com/webstore/detail/webgl-insight/djdcbmfacaaocoomokenoalbomllhnko
[3]: /user-manual/optimization/profiler/
[4]: /user-manual/optimization/guidelines/

